Finished project with the getThreadId modification.
The modification is minor, and Stop periodic thread modification is
in separate folder in case you want here to view just the submitted project
without any modifications (getThreadId is so small it wont get in the way).
